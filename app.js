!function(){"use strict";angular.module("app",["ui.router","user","admin","ngMaterial","ngMessages","factory.urlRequest","components.edit-create-task","flow","angular-md5"])}(),function(){"use strict";angular.module("admin",[])}(),function(){"use strict";angular.module("user",[])}(),function(){"use strict";function t(t,a){t.state("tasks",{url:"/tasks",templateUrl:"templates/user/user.html",controller:"user",controllerAs:"vm",resolve:{taskData:["tasks",function(t){var a={developer:"Maksym"};return t.getTasks(a).then(function(t){return t.data})}],checkRights:["auth",function(t){return t.isAdmin()}]}}).state("admin",{url:"/admin",templateUrl:"templates/admin/admin.html",controller:"admin",controllerAs:"vm"}),a.otherwise("/tasks")}t.$inject=["$stateProvider","$urlRouterProvider"],angular.module("app").config(t)}(),function(){"use strict";angular.module("app").factory("timestampMarker",[function(){return{request:function(t){return t.params||(t.params={}),/.html$/.test(t.url)||(t.params=Object.assign(t.params,{developer:"Maksym"})),t},response:function(t){return t}}}]),angular.module("app").config(["$httpProvider",function(t){t.interceptors.push("timestampMarker")}])}(),function(){"use strict";angular.module("factory.urlRequest",[]).factory("url",[function(){var t="https://uxcandy.com/~shapoval/test-task-backend/";return{tasks:{all:t,create:t+"create",edit:t+"edit/"}}}])}(),function(){"use strict";function t(t,a,e,n,s){function r(){m.task?Object.assign(m.taskData,m.task):m.task}function o(t){m.currentImage=t,m.taskData.image=t.file}function i(){u(m.taskData.email)&&m.currentImage&&m.taskData.text?e.createTask(m.taskData).then(function(a){m.addedTask=a.data.message,t.hide(m.addedTask)}):toastr.error("Invalid fields")}function u(t){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(t).toLowerCase())}function c(){m.isDone?m.taskData.status=10:m.taskData.status=0,e.editTask(m.taskData,m.task.id).then(function(a){t.hide(m.isDone)})}function l(){m.task?c():i()}function d(){t.cancel()}var m=this;m.type=n,m.task=a,m.taskData={},m.isDone=s,m.createTask=i,m.editTask=c,m.actionTask=l,m.cancel=d,m.uploadFile=o,m.validateEmail=u,m.checkTask=r,r()}t.$inject=["$mdDialog","task","tasks","type","isDone"],angular.module("components.edit-create-task",[]).controller("EditCreateTask",t)}(),function(){"use strict";function t(){function t(){return"admin"===JSON.parse(localStorage.getItem("role"))}function a(){localStorage.removeItem("role")}return{isAdmin:t,logout:a}}angular.module("app").service("auth",t)}(),function(){"use strict";function t(t,a,e){function n(e){return t.get(a.tasks.all,{params:e}).then(function(t){return t})}function s(e){return t.get(a.tasks.all,{params:e}).then(function(t){return t})}function r(e){return t.get(a.tasks.all,{params:e}).then(function(t){return t})}function o(e){var n=new FormData;return n.append("username",e.username),n.append("email",e.email),n.append("text",e.text),n.append("image",e.image),t.post(a.tasks.create,n,{transformRequest:angular.identity,headers:{"Content-Type":void 0}})}function i(n,s){var r={status:n.status,text:n.text,token:"beejee"},o="";for(var i in r)o+=encodeURI(i)+"="+encodeURI(r[i])+"&";o=o.slice(0,-1);var u=e.createHash(o),c=new FormData;return c.append("signature",u),c.append("status",r.status),c.append("text",r.text),c.append("token",r.token),t.post(a.tasks.edit+s,c,{transformRequest:angular.identity,headers:{"Content-Type":void 0}})}return{getTasks:n,getDefinePageTasks:s,getSortedTasks:r,createTask:o,editTask:i}}t.$inject=["$http","url","md5"],angular.module("app").service("tasks",t)}(),function(){"use strict";function t(t){function a(){e.form.$invalid?toastr.error("Form invalid"):"admin"===e.loginData.login&&"123"===e.loginData.password?(localStorage.setItem("role",JSON.stringify("admin")),t.go("tasks")):toastr.error("Incorrect password or email")}var e=this;e.loginData={},e.auth=a}t.$inject=["$state"],angular.module("admin").controller("admin",t)}(),function(){"use strict";function t(t,a,e,n,s,r){function o(){i(m.paginationCount)}function i(t){m.pagesCount=[];for(var a=t%3==0?t/3:Math.floor(t/3)+1,e=0;e<a;e++)m.pagesCount.push(e)}function u(){n.logout(),m.isAdmin=n.isAdmin(),toastr.success("You have successfully logout")}function c(t){var e={page:t};a.getDefinePageTasks(e).then(function(t){m.taskData=t.data.message.tasks})}function l(t,e){var n={sort_field:t,sort_direction:e};a.getSortedTasks(n).then(function(t){m.taskData=t.data.message.tasks})}function d(t,a,e){s.show({controller:"EditCreateTask",controllerAs:"vm",templateUrl:"modals/edit-create.task.html",parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0,locals:{task:a,type:e,isDone:a&&10===a.status}}).then(function(t){m.taskData.push(t),r.reload()})}var m=this;m.taskData=t.message.tasks,m.paginationCount=t.message.total_task_count,m.isAdmin=e,m.getPaginationPages=i,m.getMorePages=c,m.getSortedTasks=l,m.createEditTask=d,m.logout=u,m.activate=o,o()}t.$inject=["taskData","tasks","checkRights","auth","$mdDialog","$state"],angular.module("user").controller("user",t)}();